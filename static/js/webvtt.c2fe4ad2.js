(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["webvtt"],{b606:function(e,t,i){"use strict";i.r(t);var n=function(){this.parse=function(e,t){var i=/\r\n|\r|\n/,n=Date.now(),r=0,o=e.split(i),l=!1,u=[],f=[];function d(e,t){f.push({message:e,line:r+1,col:t})}var p=o[r],c=p.length,m="WEBVTT",v=0,h=m.length;"\ufeff"===p[0]&&(v=1,h+=1),(c<h||p.indexOf(m)!==0+v||c>h&&" "!==p[h]&&"\t"!==p[h])&&d('No valid signature. (File needs to start with "WEBVTT".)'),r++;while(""!=o[r]&&void 0!=o[r]){if(d("No blank line after the signature."),-1!=o[r].indexOf("--\x3e")){l=!0;break}r++}while(void 0!=o[r]){var g;while(!l&&""==o[r])r++;if(!l&&void 0==o[r])break;g={id:"",startTime:0,endTime:0,pauseOnExit:!1,direction:"horizontal",snapToLines:!0,linePosition:"auto",textPosition:50,size:100,alignment:"middle",text:"",tree:null};var b=!0;if(-1==o[r].indexOf("--\x3e")){if(g.id=o[r],/^NOTE($|[ \t])/.test(g.id)){r++;while(""!=o[r]&&void 0!=o[r])-1!=o[r].indexOf("--\x3e")&&d("Cannot have timestamp in a comment."),r++;continue}if(r++,""==o[r]||void 0==o[r]){d("Cue identifier cannot be standalone.");continue}-1==o[r].indexOf("--\x3e")&&(b=!1,d("Cue identifier needs to be followed by timestamp."))}l=!1;var x=new a(o[r],d),T=0;if(u.length>0&&(T=u[u.length-1].startTime),!b||x.parse(g,T)){r++;while(""!=o[r]&&void 0!=o[r]){if(-1!=o[r].indexOf("--\x3e")){d("Blank line missing before cue."),l=!0;break}""!=g.text&&(g.text+="\n"),g.text+=o[r],r++}var w=new s(g.text,d,t);g.tree=w.parse(g.startTime,g.endTime),u.push(g)}else{g=null,r++;while(""!=o[r]&&void 0!=o[r]){if(-1!=o[r].indexOf("--\x3e")){l=!0;break}r++}}}return u.sort((function(e,t){return e.startTime<t.startTime?-1:e.startTime>t.startTime?1:e.endTime>t.endTime?-1:e.endTime<t.endTime?1:0})),{cues:u,errors:f,time:Date.now()-n}}},a=function(e,t){var i=/[\u0020\t\f]/,n=/[^\u0020\t\f]/,a=(e=e,0),s=function(e){t(e,a+1)};function r(t){while(void 0!=e[a]&&t.test(e[a]))a++}function o(t){var i="";while(void 0!=e[a]&&t.test(e[a]))i+=e[a],a++;return i}function l(){var t,i,n,r,l="minutes";if(void 0!=e[a])if(/\d/.test(e[a]))if(t=o(/\d/),(t.length>2||parseInt(t,10)>59)&&(l="hours"),":"==e[a])if(a++,i=o(/\d/),2==i.length){if("hours"==l||":"==e[a]){if(":"!=e[a])return void s("No seconds found or minutes is greater than 59.");if(a++,n=o(/\d/),2!=n.length)return void s("Must be exactly two digits.")}else n=i,i=t,t="0";if("."==e[a])if(a++,r=o(/\d/),3==r.length)if(parseInt(i,10)>59)s("You cannot have more than 59 minutes.");else{if(!(parseInt(n,10)>59))return 60*parseInt(t,10)*60+60*parseInt(i,10)+parseInt(n,10)+parseInt(r,10)/1e3;s("You cannot have more than 59 seconds.")}else s("Milliseconds must be given in three digits.");else s('No decimal separator (".") found.')}else s("Must be exactly two digits.");else s("No time unit separator found.");else s("Timestamp must start with a character in the range 0-9.");else s("No timestamp found.")}function u(e,t){for(var n=e.split(i),a=[],r=0;r<n.length;r++)if(""!=n[r]){var o=n[r].indexOf(":"),l=n[r].slice(0,o);if(value=n[r].slice(o+1),-1!=a.indexOf(l)&&s("Duplicate setting."),a.push(l),""==value)return void s("No value for setting defined.");if("vertical"==l){if("rl"!=value&&"lr"!=value){s("Writing direction can only be set to 'rl' or 'rl'.");continue}t.direction=value}else if("line"==l){if(!/\d/.test(value)){s("Line position takes a number or percentage.");continue}if(-1!=value.indexOf("-",1)){s("Line position can only have '-' at the start.");continue}if(-1!=value.indexOf("%")&&value.indexOf("%")!=value.length-1){s("Line position can only have '%' at the end.");continue}if("-"==value[0]&&"%"==value[value.length-1]){s("Line position cannot be a negative percentage.");continue}if("%"==value[value.length-1]){if(parseInt(value,10)>100){s("Line position cannot be >100%.");continue}t.snapToLines=!1}t.linePosition=parseInt(value,10)}else if("position"==l){if("%"!=value[value.length-1]){s("Text position must be a percentage.");continue}if(parseInt(value,10)>100){s("Size cannot be >100%.");continue}t.textPosition=parseInt(value,10)}else if("size"==l){if("%"!=value[value.length-1]){s("Size must be a percentage.");continue}if(parseInt(value,10)>100){s("Size cannot be >100%.");continue}t.size=parseInt(value,10)}else if("align"==l){var u=["start","middle","end","left","right"];if(-1==u.indexOf(value)){s("Alignment can only be set to one of "+u.join(", ")+".");continue}t.alignment=value}else s("Invalid setting.")}}this.parse=function(t,o){if(r(i),t.startTime=l(),void 0!=t.startTime)if(t.startTime<o&&s("Start timestamp is not greater than or equal to start timestamp of previous cue."),n.test(e[a])&&s("Timestamp not separated from '--\x3e' by whitespace."),r(i),"-"==e[a])if(a++,"-"==e[a])if(a++,">"==e[a]){if(a++,n.test(e[a])&&s("'--\x3e' not separated from timestamp by whitespace."),r(i),t.endTime=l(),void 0!=t.endTime)return t.endTime<=t.startTime&&s("End timestamp is not greater than start timestamp."),n.test(e[a])&&!1,r(i),u(e.substring(a),t),!0}else s("No valid timestamp separator found.");else s("No valid timestamp separator found.");else s("No valid timestamp separator found.")},this.parseTimestamp=function(){var t=l();if(void 0==e[a])return t;s("Timestamp must not have trailing characters.")}},s=function(e,t,i){e=e;var n=0,s=function(e){"metadata"!=i&&t(e,n+1)};function r(){var t="data",i="",a="",r=[];while(void 0!=e[n-1]||0==n){var o=e[n];if("data"==t)if("&"==o)a=o,t="escape";else if("<"==o&&""==i)t="tag";else{if("<"==o||void 0==o)return["text",i];i+=o}else if("escape"==t)if("&"==o)s("Incorrect escape."),i+=a,a=o;else if(/[abglmnsprt]/.test(o))a+=o;else if(";"==o)"&amp"==a?i+="&":"&lt"==a?i+="<":"&gt"==a?i+=">":"&lrm"==a?i+="‎":"&rlm"==a?i+="‏":"&nbsp"==a?i+=" ":(s("Incorrect escape."),i+=a+";"),t="data";else{if("<"==o||void 0==o)return s("Incorrect escape."),i+=a,["text",i];s("Incorrect escape."),i+=a+o,t="data"}else if("tag"==t)if("\t"==o||"\n"==o||"\f"==o||" "==o)t="start tag annotation";else if("."==o)t="start tag class";else if("/"==o)t="end tag";else if(/\d/.test(o))i=o,t="timestamp tag";else{if(">"==o||void 0==o)return">"==o&&n++,["start tag","",[],""];i=o,t="start tag"}else if("start tag"==t)if("\t"==o||"\f"==o||" "==o)t="start tag annotation";else if("\n"==o)a=o,t="start tag annotation";else if("."==o)t="start tag class";else{if(">"==o||void 0==o)return">"==o&&n++,["start tag",i,[],""];i+=o}else if("start tag class"==t)if("\t"==o||"\f"==o||" "==o)r.push(a),a="",t="start tag annotation";else if("\n"==o)r.push(a),a=o,t="start tag annotation";else if("."==o)r.push(a),a="";else{if(">"==o||void 0==o)return">"==o&&n++,r.push(a),["start tag",i,r,""];a+=o}else if("start tag annotation"==t){if(">"==o||void 0==o)return">"==o&&n++,a=a.split(/[\u0020\t\f\r\n]+/).filter((function(e){if(e)return!0})).join(" "),["start tag",i,r,a];a+=o}else if("end tag"==t){if(">"==o||void 0==o)return">"==o&&n++,["end tag",i];i+=o}else if("timestamp tag"==t){if(">"==o||void 0==o)return">"==o&&n++,["timestamp",i];i+=o}else s("Never happens.");n++}}this.parse=function(t,o){var l={children:[]},u=l,f=[];function d(e){u.children.push({type:"object",name:e[1],classes:e[2],children:[],parent:u}),u=u.children[u.children.length-1]}function p(e){var t=u;while(t){if(t.name==e)return!0;t=t.parent}}while(void 0!=e[n]){var c=r();if("text"==c[0])u.children.push({type:"text",value:c[1],parent:u});else if("start tag"==c[0]){"chapters"==i&&s("Start tags not allowed in chapter title text.");var m=c[1];"v"!=m&&"lang"!=m&&""!=c[3]&&s("Only <v> and <lang> can have an annotation."),"c"==m||"i"==m||"b"==m||"u"==m||"ruby"==m||"rt"==m&&"ruby"==u.name?d(c):"v"==m?(p("v")&&s("<v> cannot be nested inside itself."),d(c),u.value=c[3],c[3]||s("<v> requires an annotation.")):"lang"==m?(d(c),u.value=c[3]):s("Incorrect start tag.")}else if("end tag"==c[0])"chapters"==i&&s("End tags not allowed in chapter title text."),c[1]==u.name?u=u.parent:"ruby"==c[1]&&"rt"==u.name?u=u.parent.parent:s("Incorrect end tag.");else if("timestamp"==c[0]){"chapters"==i&&s("Timestamp not allowed in chapter title text.");var v=new a(c[1],s),h=v.parseTimestamp();void 0!=h&&((h<=t||h>=o)&&s("Timestamp must be between start timestamp and end timestamp."),f.length>0&&f[f.length-1]>=h&&s("Timestamp must be greater than any previous timestamp."),u.children.push({type:"timestamp",value:h,parent:u}),f.push(h))}}while(u.parent)"v"!=u.name&&s("Required end tag missing."),u=u.parent;return l}};t["default"]=n}}]);
//# sourceMappingURL=webvtt.c2fe4ad2.js.map